"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const cli_utils_1 = require("@datocms/cli-utils");
class Command extends cli_utils_1.CmaClientCommand {
    async run() {
        try {
            this.startSpinner(`Activating maintenance mode`);
            const result = await this.client.maintenanceMode.activate({
                force: this.parsedFlags.force,
            });
            this.stopSpinner();
            return result;
        }
        catch (e) {
            if (e instanceof cli_utils_1.CmaClient.ApiError &&
                e.findError('ACTIVE_EDITING_SESSIONS')) {
                this.error('Cannot activate maintenance mode as some users are currently editing records', {
                    suggestions: ['To proceed anyway, use the --force flag'],
                });
            }
            throw e;
        }
    }
}
exports.default = Command;
Command.description = 'Put a project in maintenance mode';
Command.flags = {
    ...cli_utils_1.CmaClientCommand.flags,
    force: cli_utils_1.oclif.Flags.boolean({
        description: 'Forces the activation of maintenance mode even there are users currently editing records',
    }),
};
